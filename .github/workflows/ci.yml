name: CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3
    - name: Set up JDK 11
      uses: actions/setup-java@v3
      with:
        java-version: '11'
        distribution: 'temurin'
    - name: Build with Maven
      run: mvn clean package
    - name: Run Tests
      run: mvn test
    - name: Send Telegram Notification
      uses: appleboy/telegram-action@master
      with:
        token: ${{ 6786181092 }}
        chat_id: ${{ 1013939870 }}
        message: |
          Build status: ${{ job.status }}
          ${{ if job.status == 'success' }}
            All tests passed.
          ${{ elif job.status == 'failure' }}
            Some tests failed.
            Details: ${{ job.steps.filter(step => step.status == 'failure').name }}
          ${{ endif }}

